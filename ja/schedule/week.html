<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta http-equiv="Default-Style" content="text/css">
  <meta http-equiv="Content-Type" content="text/javascript">
  <meta name="keywords" content="shun, sato, 佐藤, 峻">
  <link rel="stylesheet" type="text/css" href="../../css/bootstrap.css">
  <link rel="stylesheet" type="text/css" href="../../css/style.css">
  <title>週間スケジュール | Shun Sato</title>

<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
  :root {
    --start-hour: 9;
    --end-hour: 18;
    --hour-height: 60px; /* 1時間の高さ */
    --time-col: 70px;
  }

  body {
    font-family: "Segoe UI", "Hiragino Sans", sans-serif;
    background:#fff;
    margin:0;
  }

  h1 { text-align:center; margin:20px 0; }

  .calendar {
    display:grid;
    grid-template-columns: var(--time-col) repeat(5,1fr);
    max-width:1000px;
    margin:0 auto;
    border:1px solid #ccc;
    border-right:none;
    border-left:none;   /* 左線を消す */
    border-top:none;    /* 上線を消す */
    border-bottom:none; /* 下線を消す */
    background:#fff;
  }

  /* ヘッダー */
  .header {
    background:#f3f6fb;
    padding:8px;
    text-align:center;
    font-weight:600;
    border-bottom:1px solid #ccc;
  }
  .calendar > .header:first-child {
    background:#fafafa;
    border-bottom:1px solid #ccc;
  }

  /* 時刻列（右側のみ線を残す） */
  .time-col {
    grid-column:1;
    background:#fff;
    position:relative;
    border-right:1px solid #ccc; /* ←右側の線だけ残す */
  }
  .time-label {
    position:absolute;
    right:4px;
    font-size:0.8rem;
    color:#555;
  }

  /* スケジュールエリア */
  .schedule-area {
    grid-column:2 / 7;
    position:relative;
    display:grid;
    grid-template-columns: repeat(5, 1fr);
    border-bottom:1px solid #ccc;
  }
  .day-col {
    position:relative;
    border-left:1px solid #eee;
    border-right:1px solid #eee;
    background:
      repeating-linear-gradient(
        to bottom,
        transparent,
        transparent calc(var(--hour-height) - 0.5px),
        #ddd calc(var(--hour-height) / 2),
        transparent calc(var(--hour-height) + 0.5px),
        transparent var(--hour-height)
      );
  }

  /* イベント */
  .event {
    position:absolute;
    left:4px; right:4px;
    background:#2a9df4;
    color:#fff;
    border-radius:6px;
    padding:4px 6px;
    font-size:1.5rem;
    line-height:1.3;
    box-shadow:0 2px 4px rgba(0,0,0,0.1);
  }
  .office { background:#74c876; }
  .lecture { background:#ffc773; }
  .seminar { background:#fd85ff; }
  .esem { background:#5ce1ff; }
</style>
</head>
<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">佐藤 峻 (Shun Sato)</span>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="../../ja">Home</a></li>
        <li><a href="../../ja/cv.html">CV</a></li>
        <li><a href="../../ja/publications.html">Publications</a></li>
        <li><a href="../../ja/links.html">Links</a></li>
        <li><a href="../../" role="button" class="btn btn-info">English</a></li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

<div id="contents">

<h1>週間スケジュール</h1>

<div style="text-align:center; margin: 20px;">
    <button onclick="loadCSV('csv/2025f.csv','2025年度 前期')" class="btn btn-info">2025年度 前期</button>
    <button onclick="loadCSV('csv/2025s.csv','2025年度 後期')" class="btn btn-info">2025年度 後期</button>
</div>

<p id="current-term" style="text-align:center; font-weight:bold; margin-bottom:20px;">
    <!-- ここに「表示中の学期」を出す -->
</p>

<div class="calendar">
  <!-- ヘッダー -->
  <div></div>
  <div class="header">月</div>
  <div class="header">火</div>
  <div class="header">水</div>
  <div class="header">木</div>
  <div class="header">金</div>

  <!-- 時刻列 -->
  <div class="time-col" id="time-col"></div>

  <!-- スケジュールエリア -->
  <div class="schedule-area">
    <div class="day-col" id="mon"></div>
    <div class="day-col" id="tue"></div>
    <div class="day-col" id="wed"></div>
    <div class="day-col" id="thu"></div>
    <div class="day-col" id="fri"></div>
  </div>
</div>

<script>
const hourHeight = 60;
const startHour = 9;
const endHour = 18;

function timeToPx(t){
  const [h,m] = t.split(":").map(Number);
  return ((h-startHour)+m/60)*hourHeight;
}

function clearEvents(){
  ["mon","tue","wed","thu","fri"].forEach(id=>{
    document.getElementById(id).innerHTML = "";
  });
}

async function loadCSV(filename, termName){
  const response = await fetch(filename);
  const text = await response.text();

  // CSV を行ごとに分解
  const rows = text.trim().split("\n").map(r => r.split(","));
  const header = rows[0];
  const data = rows.slice(1);

  clearEvents();

  data.forEach(row=>{
    const obj = {};
    header.forEach((key,i)=> obj[key]=row[i]);

    const el = document.createElement("div");
    el.className = `event ${obj.type}`;
    el.style.top = timeToPx(obj.start) + "px";
    el.style.height = (timeToPx(obj.end)-timeToPx(obj.start)) + "px";
    el.innerHTML = `${obj.title}<br>${obj.start}–${obj.end}`;
    document.getElementById(obj.day).appendChild(el);
  });

  // 表示中の学期名を更新
  document.getElementById("current-term").textContent = `表示中: ${termName}`;
}

document.addEventListener("DOMContentLoaded", ()=>{
  const timeCol = document.getElementById("time-col");
  timeCol.style.height = (endHour-startHour)*hourHeight + "px";
  for(let h=startHour; h<=endHour; h++){
    const lbl = document.createElement("div");
    lbl.className = "time-label";
    lbl.textContent = String(h).padStart(2,"0")+":00";
    lbl.style.top = ( (h-startHour)*hourHeight - 6 )+"px";
    timeCol.appendChild(lbl);
  }

  // 初期表示（前期）
  loadCSV("csv/2025s.csv", "2025年度 後期");
});
</script>

<script type="text/javascript" src="../../js/jquery-2.2.0.min.js"></script>
<script type="text/javascript" src="../../js/bootstrap.min.js"></script>
</body>
</html>